<div class="reset-password-container">
  <!-- Invalid Token State -->
  <div class="reset-password-card" *ngIf="!isValidToken">
    <div class="error-header">
      <div class="error-icon">โ๏ธ</div>
      <h1 class="error-title">LIรN KแบพT KHรNG HแปขP Lแป</h1>
      <div class="title-decoration error-decoration"></div>
      <p class="error-subtitle">
        Liรชn kแบฟt ฤแบทt lแบกi mแบญt khแบฉu ฤรฃ hแบฟt hแบกn hoแบทc khรดng hแปฃp lแป
      </p>
    </div>
    
    <div class="error-actions">
      <button type="button" class="error-btn primary" (click)="navigateToForgotPassword()">
        <span class="btn-text">YรU CแบฆU LIรN KแบพT MแปI</span>
        <div class="btn-decoration"></div>
      </button>
      
      <button type="button" class="error-btn secondary" (click)="navigateToLogin()">
        <span class="btn-text">Vแป TRANG ฤฤNG NHแบฌP</span>
        <div class="btn-decoration secondary-decoration"></div>
      </button>
    </div>
  </div>

  <!-- Valid Token - Form State -->
  <div class="reset-password-card" *ngIf="isValidToken && !isSubmitted">
    <!-- Header -->
    <div class="reset-password-header">
      <div class="icon-wrapper">
        <span class="key-icon">๐</span>
      </div>
      <h1 class="reset-password-title">ฤแบถT LแบI MแบฌT KHแบจU</h1>
      <div class="title-decoration"></div>
      <p class="reset-password-subtitle">
        Tแบกo mแบญt khแบฉu mแปi cho tรi khoแบฃn cแปงa bแบกn
      </p>
    </div>

    <!-- Form -->
    <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="reset-password-form">
      <!-- Password Field -->
      <div class="form-group">
        <label for="password" class="form-label">MแบฌT KHแบจU MแปI</label>
        <div class="input-wrapper">
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="password"
            formControlName="password"
            class="form-input password-input"
            [class.error]="resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched"
            placeholder="Tแบกo mแบญt khแบฉu mแบกnh"
          />
          <button
            type="button"
            class="password-toggle"
            (click)="togglePassword()"
          >
            <span class="password-icon">{{ showPassword ? '๐๏ธ' : '๐๏ธโ๐จ๏ธ' }}</span>
          </button>
          <div class="input-border"></div>
        </div>
        <div class="password-strength">
          <div class="strength-indicators">
            <div class="strength-bar" 
                 [class.active]="strengthLevel1"
                 [class.strong]="strengthLevel3">
            </div>
            <div class="strength-bar"
                 [class.active]="strengthLevel2"
                 [class.strong]="isStrongPassword">
            </div>
            <div class="strength-bar"
                 [class.active]="strengthLevel3"
                 [class.strong]="isStrongPassword">
            </div>
          </div>
          <p class="strength-text">Tแปi thiแปu 8 kรฝ tแปฑ, bao gแปm chแปฏ hoa, sแป vร kรฝ tแปฑ ฤแบทc biแปt</p>
        </div>
        <div class="error-message" *ngIf="resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched">
          <span *ngIf="resetPasswordForm.get('password')?.errors?.['required']">Mแบญt khแบฉu lร bแบฏt buแปc</span>
          <span *ngIf="resetPasswordForm.get('password')?.errors?.['minlength']">Mแบญt khแบฉu phแบฃi cรณ รญt nhแบฅt 8 kรฝ tแปฑ</span>
        </div>
      </div>

      <!-- Confirm Password Field -->
      <div class="form-group">
        <label for="confirmPassword" class="form-label">XรC NHแบฌN MแบฌT KHแบจU</label>
        <div class="input-wrapper">
          <input
            [type]="showConfirmPassword ? 'text' : 'password'"
            id="confirmPassword"
            formControlName="confirmPassword"
            class="form-input password-input"
            [class.error]="(resetPasswordForm.get('confirmPassword')?.invalid || resetPasswordForm.hasError('passwordMismatch')) && resetPasswordForm.get('confirmPassword')?.touched"
            placeholder="Nhแบญp lแบกi mแบญt khแบฉu mแปi"
          />
          <button
            type="button"
            class="password-toggle"
            (click)="toggleConfirmPassword()"
          >
            <span class="password-icon">{{ showConfirmPassword ? '๐๏ธ' : '๐๏ธโ๐จ๏ธ' }}</span>
          </button>
          <div class="input-border"></div>
        </div>
        <div class="error-message" *ngIf="(resetPasswordForm.get('confirmPassword')?.invalid || resetPasswordForm.hasError('passwordMismatch')) && resetPasswordForm.get('confirmPassword')?.touched">
          <span *ngIf="resetPasswordForm.get('confirmPassword')?.errors?.['required']">Xรกc nhแบญn mแบญt khแบฉu lร bแบฏt buแปc</span>
          <span *ngIf="resetPasswordForm.hasError('passwordMismatch')">Mแบญt khแบฉu khรดng khแปp</span>
        </div>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="submit-btn" [disabled]="resetPasswordForm.invalid || isLoading">
        <span class="btn-text" *ngIf="!isLoading">CแบฌP NHแบฌT MแบฌT KHแบจU</span>
        <span class="btn-text loading" *ngIf="isLoading">ฤANG CแบฌP NHแบฌT...</span>
        <div class="btn-decoration"></div>
        <div class="loading-spinner" *ngIf="isLoading"></div>
      </button>
    </form>
  </div>

  <!-- Success State -->
  <div class="reset-password-card success-card" *ngIf="isValidToken && isSubmitted">
    <div class="success-header">
      <div class="success-icon">โ</div>
      <h1 class="success-title">MแบฌT KHแบจU ฤร CแบฌP NHแบฌT</h1>
      <div class="title-decoration success-decoration"></div>
      <p class="success-subtitle">
        Mแบญt khแบฉu cแปงa bแบกn ฤรฃ ฤฦฐแปฃc thay ฤแปi thรnh cรดng!
      </p>
    </div>

    <div class="success-content">
      <div class="success-info">
        <p>๐ Tรi khoแบฃn cแปงa bแบกn ฤรฃ ฤฦฐแปฃc bแบฃo mแบญt</p>
        <p>๐ Hรฃy ฤฤng nhแบญp vแปi mแบญt khแบฉu mแปi</p>
      </div>
      
      <button type="button" class="success-btn" (click)="navigateToLogin()">
        <span class="btn-text">ฤฤNG NHแบฌP NGAY</span>
        <div class="success-btn-decoration"></div>
      </button>
    </div>
  </div>

  <!-- Decorative Elements -->
  <div class="decoration decoration-1"></div>
  <div class="decoration decoration-2"></div>
  <div class="decoration decoration-3"></div>

  <!-- Background Shapes -->
  <div class="bg-shape bg-shape-1"></div>
  <div class="bg-shape bg-shape-2"></div>
  <div class="bg-shape bg-shape-3"></div>
</div>