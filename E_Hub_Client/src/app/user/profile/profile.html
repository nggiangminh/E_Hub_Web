<!-- User Profile Template -->
<div class="profile-container">
  <!-- Decorative Elements -->
  <div class="geometric-decoration decoration-1"></div>
  <div class="geometric-decoration decoration-2"></div>
  <div class="geometric-decoration decoration-3"></div>

  <!-- Profile Card -->
  <div class="profile-card">
    <!-- Header Section -->
    <div class="profile-header">
      <div class="avatar-section">
        <div class="avatar-wrapper">
          <img [src]="user.avatarUrl || defaultAvatar" [alt]="user.fullName" class="avatar-image">
          <button type="button" class="avatar-edit-btn" (click)="triggerFileInput()">
            <span class="edit-icon">üì∏</span>
          </button>
        </div>
        <input #fileInput type="file" accept="image/*" (change)="onAvatarSelect($event)" class="file-input">
      </div>
      
      <div class="user-info">
        <h1 class="user-name">{{ user.fullName }}</h1>
        <span class="user-role" [class]="'role-' + user.role.toLowerCase()">{{ getRoleDisplay(user.role) }}</span>
        <span class="user-status" [class]="'status-' + user.status.toLowerCase()">{{ getStatusDisplay(user.status) }}</span>
      </div>
    </div>

    <!-- Profile Form -->
    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="profile-form">
      
      <!-- Full Name -->
      <div class="form-group">
        <label class="form-label">H·ªç v√† t√™n</label>
        <input type="text" 
               formControlName="fullName"
               class="form-input"
               placeholder="Nh·∫≠p h·ªç v√† t√™n c·ªßa b·∫°n"
               [class.error]="isFieldInvalid('fullName')">
        <div *ngIf="isFieldInvalid('fullName')" class="error-message">
          <span *ngIf="profileForm.get('fullName')?.errors?.['required']">Vui l√≤ng nh·∫≠p h·ªç v√† t√™n</span>
          <span *ngIf="profileForm.get('fullName')?.errors?.['minlength']">H·ªç v√† t√™n ph·∫£i c√≥ √≠t nh·∫•t 2 k√Ω t·ª±</span>
          <span *ngIf="profileForm.get('fullName')?.errors?.['maxlength']">H·ªç v√† t√™n kh√¥ng ƒë∆∞·ª£c v∆∞·ª£t qu√° 100 k√Ω t·ª±</span>
        </div>
      </div>

      <!-- Email -->
      <div class="form-group">
        <label class="form-label">Email</label>
        <input type="email" 
               formControlName="email"
               class="form-input"
               placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ email"
               [class.error]="isFieldInvalid('email')">
        <div *ngIf="isFieldInvalid('email')" class="error-message">
          <span *ngIf="profileForm.get('email')?.errors?.['required']">Vui l√≤ng nh·∫≠p email</span>
          <span *ngIf="profileForm.get('email')?.errors?.['email']">Email kh√¥ng h·ª£p l·ªá</span>
        </div>
      </div>

      <!-- Bio -->
      <div class="form-group">
        <label class="form-label">Gi·ªõi thi·ªáu b·∫£n th√¢n</label>
        <textarea formControlName="bio"
                  class="form-textarea"
                  placeholder="Vi·∫øt v√†i d√≤ng gi·ªõi thi·ªáu v·ªÅ b·∫£n th√¢n..."
                  rows="4"
                  [class.error]="isFieldInvalid('bio')"></textarea>
        <div class="char-counter">{{ bioLength }}/500</div>
        <div *ngIf="isFieldInvalid('bio')" class="error-message">
          <span *ngIf="profileForm.get('bio')?.errors?.['maxlength']">Gi·ªõi thi·ªáu kh√¥ng ƒë∆∞·ª£c v∆∞·ª£t qu√° 500 k√Ω t·ª±</span>
        </div>
      </div>

      <!-- Account Information (Read-only) -->
      <div class="account-info">
        <h3 class="section-title">Th√¥ng tin t√†i kho·∫£n</h3>
        
        <div class="info-row">
          <span class="info-label">Ng√†y t·∫°o t√†i kho·∫£n:</span>
          <span class="info-value">{{ formatDate(user.createdAt) }}</span>
        </div>
        
        <div class="info-row">
          <span class="info-label">L·∫ßn ƒëƒÉng nh·∫≠p cu·ªëi:</span>
          <span class="info-value">{{ formatDate(user.lastLoginAt) }}</span>
        </div>
        
        <div class="info-row">
          <span class="info-label">C·∫≠p nh·∫≠t l·∫ßn cu·ªëi:</span>
          <span class="info-value">{{ formatDate(user.updatedAt) }}</span>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="button-group">
        <button type="button" 
                class="btn btn-secondary" 
                (click)="resetForm()">
          H·ªßy b·ªè
        </button>
        
        <button type="submit" 
                class="btn btn-primary"
                [disabled]="profileForm.invalid || isLoading">
          <span *ngIf="isLoading" class="loading-spinner"></span>
          {{ isLoading ? 'ƒêang l∆∞u...' : 'L∆∞u thay ƒë·ªïi' }}
        </button>
      </div>

    </form>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <button type="button" class="action-btn" routerLink="/user/settings">
      <span class="action-icon">‚öôÔ∏è</span>
      <span class="action-text">C√†i ƒë·∫∑t t√†i kho·∫£n</span>
    </button>
    
    <button type="button" class="action-btn" (click)="downloadProfile()">
      <span class="action-icon">üìÑ</span>
      <span class="action-text">Xu·∫•t th√¥ng tin</span>
    </button>
    
    <button type="button" class="action-btn danger" (click)="showDeleteConfirm = true">
      <span class="action-icon">üóëÔ∏è</span>
      <span class="action-text">X√≥a t√†i kho·∫£n</span>
    </button>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div *ngIf="showDeleteConfirm" class="modal-overlay" (click)="showDeleteConfirm = false">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <h2 class="modal-title">X√°c nh·∫≠n x√≥a t√†i kho·∫£n</h2>
    <p class="modal-text">
      B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t√†i kho·∫£n? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.
    </p>
    <div class="modal-actions">
      <button type="button" class="btn btn-secondary" (click)="showDeleteConfirm = false">
        H·ªßy b·ªè
      </button>
      <button type="button" class="btn btn-danger" (click)="deleteAccount()">
        X√≥a t√†i kho·∫£n
      </button>
    </div>
  </div>
</div>