<!-- Enrollment Form Component -->
<div class="enrollment-form-page">
  <!-- Header Section -->
  <div class="page-header">
    <button class="back-btn" (click)="goBack()">
      <i class="icon">‚Üê</i>
      QUAY L·∫†I
    </button>
    <div class="header-content">
      <h1 class="page-title">ƒêƒÇNG K√ù KH√ìA H·ªåC</h1>
      <p class="page-subtitle">Tham gia kh√≥a h·ªçc v√† b·∫Øt ƒë·∫ßu h√†nh tr√¨nh h·ªçc t·∫≠p</p>
    </div>
    <div class="course-preview-mini" *ngIf="selectedCourse">
      <img [src]="selectedCourse.thumbnail" [alt]="selectedCourse.title">
      <span class="course-title">{{ selectedCourse.title }}</span>
    </div>
  </div>

  <div class="content-container" *ngIf="selectedCourse">
    <div class="enrollment-container">
      <!-- Course Summary Card -->
      <div class="course-summary-card">
        <div class="course-image">
          <img [src]="selectedCourse.thumbnail" [alt]="selectedCourse.title">
          <div class="course-badge" [class]="selectedCourse.level.toLowerCase()">
            {{ getLevelText(selectedCourse.level) }}
          </div>
          <div class="price-badge">
            <span class="price">{{ formatPrice(selectedCourse.price) }}</span>
            <span class="original-price" *ngIf="selectedCourse.originalPrice">
              {{ formatPrice(selectedCourse.originalPrice) }}
            </span>
          </div>
        </div>
        
        <div class="course-info">
          <h2 class="course-title">{{ selectedCourse.title }}</h2>
          <p class="course-instructor">
            <i class="icon">üë®‚Äçüè´</i>
            {{ selectedCourse.instructor }}
          </p>
          <p class="course-description">{{ selectedCourse.description }}</p>
          
          <div class="course-highlights">
            <div class="highlight-item">
              <i class="icon">üìö</i>
              <span>{{ selectedCourse.totalLessons }} b√†i h·ªçc</span>
            </div>
            <div class="highlight-item">
              <i class="icon">‚è±Ô∏è</i>
              <span>{{ selectedCourse.duration }} gi·ªù</span>
            </div>
            <div class="highlight-item">
              <i class="icon">üèÜ</i>
              <span>Ch·ª©ng ch·ªâ ho√†n th√†nh</span>
            </div>
            <div class="highlight-item">
              <i class="icon">‚ôæÔ∏è</i>
              <span>Truy c·∫≠p vƒ©nh vi·ªÖn</span>
            </div>
          </div>

          <div class="course-rating" *ngIf="selectedCourse.rating">
            <div class="rating-stars">
              <span class="star" *ngFor="let star of getRatingStars(selectedCourse.rating)" [class.filled]="star">‚≠ê</span>
            </div>
            <span class="rating-score">{{ selectedCourse.rating }}/5</span>
            <span class="rating-count">({{ selectedCourse.reviewCount }} ƒë√°nh gi√°)</span>
          </div>
        </div>
      </div>

      <!-- Enrollment Form -->
      <div class="enrollment-form-card">
        <h3 class="form-title">
          <i class="icon">üìù</i>
          TH√îNG TIN ƒêƒÇNG K√ù
        </h3>

        <form #enrollmentForm="ngForm" (ngSubmit)="onSubmit(enrollmentForm)" class="enrollment-form">
          <!-- Personal Information -->
          <div class="form-section">
            <h4 class="section-title">TH√îNG TIN C√Å NH√ÇN</h4>
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label">H·ªç v√† t√™n *</label>
                <input
                  type="text"
                  class="form-input"
                  [(ngModel)]="formData.fullName"
                  name="fullName"
                  required
                  placeholder="Nh·∫≠p h·ªç v√† t√™n ƒë·∫ßy ƒë·ªß"
                  #fullName="ngModel"
                >
                <div class="error-message" *ngIf="fullName.invalid && fullName.touched">
                  Vui l√≤ng nh·∫≠p h·ªç v√† t√™n
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">Email *</label>
                <input
                  type="email"
                  class="form-input"
                  [(ngModel)]="formData.email"
                  name="email"
                  required
                  email
                  placeholder="example@email.com"
                  #email="ngModel"
                >
                <div class="error-message" *ngIf="email.invalid && email.touched">
                  <span *ngIf="email.errors?.['required']">Vui l√≤ng nh·∫≠p email</span>
                  <span *ngIf="email.errors?.['email']">Email kh√¥ng h·ª£p l·ªá</span>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">S·ªë ƒëi·ªán tho·∫°i *</label>
                <input
                  type="tel"
                  class="form-input"
                  [(ngModel)]="formData.phone"
                  name="phone"
                  required
                  placeholder="0123456789"
                  pattern="[0-9]{10,11}"
                  #phone="ngModel"
                >
                <div class="error-message" *ngIf="phone.invalid && phone.touched">
                  <span *ngIf="phone.errors?.['required']">Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i</span>
                  <span *ngIf="phone.errors?.['pattern']">S·ªë ƒëi·ªán tho·∫°i kh√¥ng h·ª£p l·ªá</span>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">Ngh·ªÅ nghi·ªáp</label>
                <select class="form-select" [(ngModel)]="formData.occupation" name="occupation">
                  <option value="">Ch·ªçn ngh·ªÅ nghi·ªáp</option>
                  <option value="student">H·ªçc sinh/Sinh vi√™n</option>
                  <option value="developer">L·∫≠p tr√¨nh vi√™n</option>
                  <option value="designer">Thi·∫øt k·∫ø</option>
                  <option value="manager">Qu·∫£n l√Ω</option>
                  <option value="freelancer">Freelancer</option>
                  <option value="other">Kh√°c</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Learning Goals -->
          <div class="form-section">
            <h4 class="section-title">M·ª§C TI√äU H·ªåC T·∫¨P</h4>
            <div class="form-group">
              <label class="form-label">M·ª•c ti√™u c·ªßa b·∫°n khi tham gia kh√≥a h·ªçc n√†y?</label>
              <textarea
                class="form-textarea"
                [(ngModel)]="formData.learningGoals"
                name="learningGoals"
                rows="4"
                placeholder="Chia s·∫ª m·ª•c ti√™u h·ªçc t·∫≠p c·ªßa b·∫°n (kh√¥ng b·∫Øt bu·ªôc)"
              ></textarea>
            </div>

            <div class="form-group">
              <label class="form-label">Kinh nghi·ªám tr∆∞·ªõc ƒë√≥</label>
              <div class="radio-group">
                <label class="radio-option">
                  <input
                    type="radio"
                    name="experience"
                    value="beginner"
                    [(ngModel)]="formData.experience"
                  >
                  <span class="radio-custom"></span>
                  Ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu
                </label>
                <label class="radio-option">
                  <input
                    type="radio"
                    name="experience"
                    value="intermediate"
                    [(ngModel)]="formData.experience"
                  >
                  <span class="radio-custom"></span>
                  C√≥ kinh nghi·ªám c∆° b·∫£n
                </label>
                <label class="radio-option">
                  <input
                    type="radio"
                    name="experience"
                    value="advanced"
                    [(ngModel)]="formData.experience"
                  >
                  <span class="radio-custom"></span>
                  C√≥ kinh nghi·ªám n√¢ng cao
                </label>
              </div>
            </div>
          </div>

          <!-- Payment Section -->
          <div class="form-section">
            <h4 class="section-title">TH√îNG TIN THANH TO√ÅN</h4>
            
            <!-- Pricing Summary -->
            <div class="pricing-summary">
              <div class="price-row">
                <span class="price-label">Gi√° kh√≥a h·ªçc:</span>
                <span class="price-value">{{ formatPrice(selectedCourse.price) }}</span>
              </div>
              <div class="price-row" *ngIf="selectedDiscount">
                <span class="price-label">Gi·∫£m gi√° ({{ selectedDiscount.code }}):</span>
                <span class="price-value discount">-{{ formatPrice(getDiscountAmount()) }}</span>
              </div>
              <div class="price-row total">
                <span class="price-label">T·ªïng thanh to√°n:</span>
                <span class="price-value">{{ formatPrice(getFinalPrice()) }}</span>
              </div>
            </div>

            <!-- Discount Code -->
            <div class="form-group">
              <label class="form-label">M√£ gi·∫£m gi√°</label>
              <div class="discount-input">
                <input
                  type="text"
                  class="form-input"
                  [(ngModel)]="discountCode"
                  name="discountCode"
                  placeholder="Nh·∫≠p m√£ gi·∫£m gi√°"
                  [disabled]="!!selectedDiscount"
                >
                <button
                  type="button"
                  class="apply-discount-btn"
                  (click)="applyDiscount()"
                  [disabled]="!discountCode || !!selectedDiscount"
                >
                  {{ selectedDiscount ? 'ƒê√É √ÅP D·ª§NG' : '√ÅP D·ª§NG' }}
                </button>
              </div>
              <div class="success-message" *ngIf="selectedDiscount">
                ‚úÖ ƒê√£ √°p d·ª•ng m√£ gi·∫£m gi√°: {{ selectedDiscount.description }}
              </div>
            </div>

            <!-- Payment Method -->
            <div class="form-group">
              <label class="form-label">Ph∆∞∆°ng th·ª©c thanh to√°n *</label>
              <div class="payment-methods">
                <label class="payment-option" *ngFor="let method of paymentMethods">
                  <input
                    type="radio"
                    name="paymentMethod"
                    [value]="method.id"
                    [(ngModel)]="formData.paymentMethod"
                    required
                  >
                  <div class="payment-card">
                    <div class="payment-icon">{{ method.icon }}</div>
                    <div class="payment-info">
                      <span class="payment-name">{{ method.name }}</span>
                      <span class="payment-desc">{{ method.description }}</span>
                    </div>
                    <div class="payment-badge" *ngIf="method.popular">HOT</div>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <!-- Terms and Conditions -->
          <div class="form-section">
            <div class="terms-section">
              <label class="checkbox-group">
                <input
                  type="checkbox"
                  [(ngModel)]="formData.agreeTerms"
                  name="agreeTerms"
                  required
                  #agreeTerms="ngModel"
                >
                <span class="checkbox-custom"></span>
                <span class="checkbox-text">
                  T√¥i ƒë·ªìng √Ω v·ªõi 
                  <a href="#" class="terms-link" (click)="showTerms($event)">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a>
                  v√† 
                  <a href="#" class="terms-link" (click)="showPrivacy($event)">Ch√≠nh s√°ch b·∫£o m·∫≠t</a>
                </span>
              </label>
              <div class="error-message" *ngIf="agreeTerms.invalid && agreeTerms.touched">
                Vui l√≤ng ƒë·ªìng √Ω v·ªõi ƒëi·ªÅu kho·∫£n
              </div>

              <label class="checkbox-group">
                <input
                  type="checkbox"
                  [(ngModel)]="formData.subscribeNewsletter"
                  name="subscribeNewsletter"
                >
                <span class="checkbox-custom"></span>
                <span class="checkbox-text">
                  T√¥i mu·ªën nh·∫≠n th√¥ng b√°o v·ªÅ kh√≥a h·ªçc v√† ∆∞u ƒë√£i m·ªõi
                </span>
              </label>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="form-actions">
            <button type="button" class="btn btn-outline" (click)="goBack()">
              <i class="icon">‚Üê </i>
              H·ª¶Y ƒêƒÇNG K√ù
            </button>
            <button 
              type="submit" 
              class="btn btn-primary"
              [disabled]="enrollmentForm.invalid || isSubmitting"
            >
              <i class="icon">{{ isSubmitting ? '‚è≥' : 'üí≥' }}</i>
              {{ isSubmitting ? 'ƒêANG X·ª¨ L√ù...' : 'THANH TO√ÅN & ƒêƒÇNG K√ù' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Security & Support Info -->
    <div class="security-info">
      <div class="security-badges">
        <div class="security-badge">
          <i class="icon">üîí</i>
          <span>Thanh to√°n b·∫£o m·∫≠t SSL</span>
        </div>
        <div class="security-badge">
          <i class="icon">üõ°Ô∏è</i>
          <span>Th√¥ng tin ƒë∆∞·ª£c m√£ h√≥a</span>
        </div>
        <div class="security-badge">
          <i class="icon">üìû</i>
          <span>H·ªó tr·ª£ 24/7</span>
        </div>
        <div class="security-badge">
          <i class="icon">üíØ</i>
          <span>ƒê·∫£m b·∫£o ho√†n ti·ªÅn</span>
        </div>
      </div>
      
      <div class="support-contact">
        <p>C·∫ßn h·ªó tr·ª£? Li√™n h·ªá: <strong>hotline@ehub.com</strong> ho·∫∑c <strong>1900-1234</strong></p>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="!selectedCourse">
    <div class="loading-spinner">
      <div class="spinner"></div>
      <p>ƒêANG T·∫¢I TH√îNG TIN KH√ìA H·ªåC...</p>
    </div>
  </div>

  <!-- Terms Modal -->
  <div class="modal-overlay" *ngIf="showTermsModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>ƒêI·ªÄU KHO·∫¢N S·ª¨ D·ª§NG</h3>
        <button class="close-btn" (click)="closeModal()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="terms-content">
          <h4>1. ƒêi·ªÅu kho·∫£n chung</h4>
          <p>B·∫±ng vi·ªác s·ª≠ d·ª•ng d·ªãch v·ª•, b·∫°n ƒë·ªìng √Ω tu√¢n th·ªß c√°c ƒëi·ªÅu kho·∫£n n√†y.</p>
          
          <h4>2. Quy·ªÅn s·ªü h·ªØu tr√≠ tu·ªá</h4>
          <p>T·∫•t c·∫£ n·ªôi dung kh√≥a h·ªçc thu·ªôc b·∫£n quy·ªÅn c·ªßa E-Hub v√† c√°c gi·∫£ng vi√™n.</p>
          
          <h4>3. Ch√≠nh s√°ch ho√†n ti·ªÅn</h4>
          <p>Ho√†n ti·ªÅn 100% trong 30 ng√†y ƒë·∫ßu n·∫øu kh√¥ng h√†i l√≤ng.</p>
          
          <h4>4. Tr√°ch nhi·ªám ng∆∞·ªùi d√πng</h4>
          <p>Kh√¥ng chia s·∫ª t√†i kho·∫£n ho·∫∑c n·ªôi dung kh√≥a h·ªçc cho b√™n th·ª© ba.</p>
        </div>
      </div>
    </div>
  </div>
</div>